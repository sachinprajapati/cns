{% extends 'base.html' %}

{% block content %}

{% include 'navbar.html' %}
<br/>
<div class="container-fluid">
  <table class="table table-hover table-sm table-bordered" id="production">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Date & Time</th>
      <th scope="col">Count</th>
      <th scope="col">Rating</th>
      <th scope="col">Hold V</th>
      <th scope="col">Trip V</th>
      <th scope="col">ARC</th>
      <th scope="col">Cont</th>
      <th scope="col">Hold</th>
      <th scope="col">Hold A</th>
      <th scope="col">Hold T</th>
      <th scope="col">Trip</th>
      <th scope="col">Trip A</th>
      <th scope="col">Trip T</th>
      <th scope="col">KNR</th>
      <th scope="col">HV</th>
      <th scope="col">Status</th>
    </tr>
  </thead>
  <tbody>
    {% for d in data %}
      <tr {% if forloop.last %}class="highlight"{% endif%}>
        <th scope="row">{{ d.dt }}</th>
        <td>{{ count|add:forloop.counter }}</td>
        <td>{{ d.rating }}</td>
        <td>{{ d.hold_v }}</td>
        <td>{{ d.trip_v }}</td>
        <td>{{ d.get_arc_display }}</td>
        <td>{{ d.get_cont_display }}</td>
        <td>{{ d.get_hold_display }}</td>
        <td>{{ d.hold_a }}</td>
        <td>{{ d.hold_t }}</td>
        <td>{{ d.trip }}</td>
        <td>{{ d.trip_a }}</td>
        <td>{{ d.trip_t }}</td>
        <td>{{ d.get_knr_display }}</td>
        <td>{{ d.get_hv_display }}</td>
        <td>{{ d.get_status_display }}</td>
      </tr>
    {% endfor %}
    <!-- <tr>
      <th scope="row">2</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">3</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">4</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">5</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">6</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">7</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">8</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">9</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr>
    <tr>
      <th scope="row">10</th>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
      <td>Mark</td>
      <td>Otto</td>
      <td>@mdo</td>
    </tr> -->
  </tbody>
  </table>
</div>
<script type="text/javascript">
//   setTimeout(function(){
//    window.location.reload(1);
// }, 1000);
</script>

<script type="text/javascript">
  $( document ).ready(function() {
    $.ajax({
      type: "POST",  
      url: "{% url 'users:get-status' %}",
      data: {
        "msg": "request",
        csrfmiddlewaretoken: '{{ csrf_token }}'
      }, 
      success: function(data){  
          $("form#updatejob").hide(function(){$("div.success").fadeIn();});
          var table = document.getElementById("production").rows;
          // for(var i = 1; i<=10; i++){
          //   console.log("row "+i, table[i])
          // }
          for (i in data['data']){
            var d = new Date(data['data'][i]['dt']);
            table[i+1].cells[0].innerHTML = 'sdfsf';
            console.log(dt);
          }
      },
      error: function(XMLHttpRequest, textStatus, errorThrown) { 
          console.log("Status: " + textStatus); console.log("Error: " + errorThrown); 
      }       
    });
  });
</script>


<script type="text/javascript">
  // count = 1
  // var time = 1;

  // var table = document.getElementById("production");

  // var interval = setInterval(function() { 
  //     console.log(table.rows[time]+time);
  //     var d = new Date();
  //     $.ajax({
  //       type: "POST",  
  //       url: "{% url 'users:procces' %}",
  //       data: {
  //         "msg": "request",
  //         csrfmiddlewaretoken: '{{ csrf_token }}'
  //       }, 
  //       success: function(){  
  //           $("form#updatejob").hide(function(){$("div.success").fadeIn();});  
  //       },
  //       error: function(XMLHttpRequest, textStatus, errorThrown) { 
  //           console.log("Status: " + textStatus); console.log("Error: " + errorThrown); 
  //       }       
  //     });
  //     if(time>10){
  //       time=1;
  //       $(table.rows[10]).removeClass("highlight");
  //     }
  //     $(table.rows[time]).addClass("highlight");
  //     table.rows[time].cells[0].innerHTML = [d.getMonth()+1,
  //              d.getDate(),
  //              d.getFullYear()].join('/')+' '+
  //             [d.getHours(),
  //              d.getMinutes(),
  //              d.getSeconds()].join(':');
  //     table.rows[time].cells[1].innerHTML = count;
  //     if(time>1){$(table.rows[time-1]).removeClass("highlight");}
  //     time++;count++;
  // }, 2000);
</script>

<style type="text/css">
  .highlight{
    background: #33ccff;
  }
</style>

<div class="container-fluid">
  <h3 class="text-center">Summary</h3>
  <table class="table table-hover table-sm table-bordered">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Date & Time</th>
      <th scope="col">Count</th>
      <th scope="col">ARC Fail</th>
      <th scope="col">Cont Fail</th>
      <th scope="col">Hold Fail</th>
      <th scope="col">Trip Fail</th>
      <th scope="col">KNR Fail</th>
      <th scope="col">HV Fail</th>
      <th scope="col">Total Fail</th>
      <th scope="col">Total Pass</th>
      <th scope="col">% Rejection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row" id="today"></th>
      <td>{{ tcount }}</td>
      <td>{{ f_arc }}</td>
      <td>{{ f_cont }}</td>
      <td>{{ f_hold }}</td>
      <td>{{ f_trip }}</td>
      <td>{{ f_knr }}</td>
      <td>{{ f_hv }}</td>
      <td>{{ rej }}</td>
      <td>{{ passed }}</td>
      <td>{{ rej_rate }}</td>
    </tr>
  </tbody>
</table>
</div>
<script type="text/javascript">
  var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
  var d = new Date();
  document.getElementById("today").innerHTML = d.toLocaleDateString("hi-IN");
</script>
<div class="text-center">
  <a href="{% url 'users:reports' %}"><button type="button" class="btn btn-primary btn-sm">Reports</button></a>
  <a href="{% url 'users:homepage' %}"><button type="button" disabled="" class="btn btn-primary btn-sm active">Receive Data</button></a>
</div>
<br/>
{% if errors %}
  <div class="alert alert-danger" role="alert">
    {{ errors }}
  </div>
{% endif %}
{% endblock %}